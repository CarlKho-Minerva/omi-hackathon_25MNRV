# Firestore Schema for Omi Wrapped App

This document outlines the Firestore collection structures used by the application.

## `raw_memories` (Collection)

Stores raw data extracted directly from the Omi Memory Creation Webhook trigger. Documents are named based on the user and date to group daily memories.

*   **Document ID:** `{USERID}_{YYYY-MM-DD}` (e.g., `ckVQW3MVAoenlOdYhHLt5K3zPpW2_2025-03-30`)
*   **Fields:**
    *   `memories` (Array): An array containing objects for each memory processed on that specific day for that user.
        *   **Object Structure within `memories` Array:**
            *   `memory_id` (String): The unique ID of the Omi memory.
            *   `transcript` (String): The full transcript extracted from the memory payload.
            *   `started_at` (Timestamp): Firestore Timestamp indicating when the conversation started.
            *   `finished_at` (Timestamp): Firestore Timestamp indicating when the conversation ended.
            *   `geolocation` (Map | Null): Firestore Map containing `latitude` and `longitude` (or Null if not provided). Example: `{latitude: 37.77, longitude: -122.41}`.
            *   `webhook_received_at` (Timestamp): Firestore Timestamp indicating when the webhook initially processed this memory entry.

## `daily_reflections` (Collection)

Stores the processed results generated by the nightly Cloud Function after analyzing the day's raw memories using OpenAI.

*   **Document ID:** `{USERID}_{YYYY-MM-DD}` (e.g., `ckVQW3MVAoenlOdYhHLt5K3zPpW2_2025-03-30`) - Matches the corresponding raw data document ID.
*   **Fields:**
    *   `processed_at` (Timestamp): Firestore Timestamp indicating when the daily processing job completed for this entry.
    *   `daily_emoji` (String): Single emoji representing the day's overall mood/theme.
    *   `summary` (String): A brief 1-2 sentence summary of the day's conversations/mood.
    *   `gratitude_points` (Array<String>): An array of strings, each being a specific point of gratitude identified. (e.g., `["Finished the project report", "Had a nice chat with Sarah"]`)
    *   `learned_terms` (Array<Map>): An array of objects detailing learned jargon or concepts.
        *   **Object Structure:** `{ term: string, definition: string }` (e.g., `{term: "API", definition: "Application Programming Interface..."}`)
    *   `little_things` (Array<Map>): An array of objects detailing small, actionable observations.
        *   **Object Structure:** `{ mention: string, suggested_action: string }` (e.g., `{mention: "Joey likes donuts", suggested_action: "Buy donuts for Joey"}`)
    *   `mentor_advice` (String): A single, concise piece of advice or observation from the AI mentor based on the day's events.
    *   `action_items` (Array<String>): An array of explicit action items extracted directly from the conversations. (e.g., `["Email Bob about the slides", "Schedule team meeting"]`)